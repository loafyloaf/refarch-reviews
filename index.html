<!DOCTYPE html>
<html>

  <head>
    <title>RefArch Demo Customer Feedback Application</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="stylesheets/global.css">
    <link rel="stylesheet" href="stylesheets/header.css">
    <link rel="stylesheet" href="stylesheets/reviews.css">
  </head>

  <body onload="listReviews()">
    
    <div class="header">
      <div class="title">
        RefArch Demo Customer Feedback Application
      </div>
    </div>    


    <div class="reviews">
      <div> 
          <h3>Product Reviews for PURPLE LIPSTICK</h3><br>
      </div>
      <br>
      <img src="img/purple_lipstick.jpeg">
      <div id="rlist" style="width: 4000px: height: 100px"></div>

        <form></br>
	    <h4>Would you like to leave a review?</h4>
            Your Name: <input type="text" id="rname" name="name" placeholder="Your name"/><br>
            Your Rating: <select id="rrating" name="rating">
              <option value="none"> </option>
              <option value="1 star">1 star</option>
              <option value="2 stars">2 stars</option>
              <option value="3 stars">3 stars</option>
              <option value="4 stars">4 stars</option>
              <option value="5 stars">5 stars</option>
            </select><br>
            How did you like our product?<textarea id="rbody" name="body" rows="5" cols="30"></textarea><br>
            <button type="button" onclick="addReview()" value="Click here to submit the form">Submit your review</button>
        </form>

    </div>
  </body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js"></script>
<script>
function addReview() {
  console.log("hitdb()");
  axios.post(
    "https://service.us.apiconnect.ibmcloud.com/gws/apigateway/api/0c8f59e1d1d5405e25c88917bb965b2defd073b8ed3b5717183d253c13758c1a/refarchReviews/addReview", {
      name: document.getElementById("rname").value,
      rating: document.getElementById("rrating").value,
      body: document.getElementById("rbody").value
    }, {
      headers: { 'Content-Type': 'application/json' }
    })
    .then(function (response) {
     console.log(response);
     listReviews();
    })
    .catch(function (error) {
     console.log("error: ", error);
    })
}
</script>
<script>
function listReviews() {
  console.log("listreviews");
  axios.get(
    "https://service.us.apiconnect.ibmcloud.com/gws/apigateway/api/0c8f59e1d1d5405e25c88917bb965b2defd073b8ed3b5717183d253c13758c1a/refarchReviews/listReviews", {
    }, {
      headers: { 'Content-Type': 'application/json' }
    })
    .then(function (response) {
    console.log(response);
    var rList = JSON.parse(response.data.msg.body);
    var rListText = "<br><h4>Previous Reviews</h4>";
    for ( var i=0;i<rList.docs.length;i++)
      {
        rListText = rListText + "<div class='imageLabel'>" + "Reviewer Name: " + rList.docs[i].name + "<br/>" + "Rating: " + rList.docs[i].rating + "<br>" + "Review: " + rList.docs[i].body + "<br></div><br>";
      };
    document.getElementById("rlist").innerHTML = rListText;
    })
    .catch(function (error) {
    console.log(error);
    });
}

</script>
</html>
<script src="scripts/getProductImage.js"></script>
